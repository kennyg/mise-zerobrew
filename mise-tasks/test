#!/usr/bin/env bash
#MISE description="Run backend plugin tests"
set -euo pipefail

echo "Testing plugin structure..."

# Check required files exist
for file in metadata.lua hooks/backend_list_versions.lua hooks/backend_install.lua hooks/backend_exec_env.lua; do
    if [[ -f "$file" ]]; then
        echo "✓ $file exists"
    else
        echo "✗ $file missing"
        exit 1
    fi
done

# Check Lua syntax
echo "Checking Lua syntax..."
for file in metadata.lua hooks/*.lua; do
    if luac -p "$file" 2>/dev/null; then
        echo "✓ $file syntax OK"
    else
        echo "⚠ $file syntax check skipped (luac not available)"
    fi
done

echo "✓ Plugin structure tests passed"
